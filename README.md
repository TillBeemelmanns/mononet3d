# 3D Monocular object detection

Relatively simple 3D monocular object detection pipeline written in `tensorflow 2`.

## Approach

## Setup

All dependencies can be install in a python virtual environment using pip:

```
virtualenv -p <python_path>/python3 ./env
source ./env/bin/activation
pip install -r requirements.txt
```

## Training

To use the standard kitti dataset example you must first download the kitti dataset from [here](). Once downloaded set the `in_dir` value in the config dictionary in `datasets/create_tfrecord` to the kitti downolad root folder. The tfrecords can be generated by running:

```
python datasets/create_tfrecord.py
```

By default the class map ground `cars`, `trucks` and `vans` as a single class and sets everything else to `dont care`. You can change this by editing the values in `CLASS_MAP` located at the top of `datasets/kitti_utils`. We also provide an example for all classes.

We provide 2 examples for training configs. One for single class (`configs/kitti_single.toml`) and a mulit-class (`configs/kitti_multi.toml`). Ensure these match the parameters set when generating the dataset. Once configured correctly training can be begin by running:

```
python network/train <config_path>
```

Training logs can be visulaised using tensorboard:

```
tensorboard --logdir=./logs --port=6006
```

Then browse to `localhost:6006` in your web browser.

## Evaluation

Evaluation can be configured be editing the `cfg` dictionary at the bottom of `network/evaluate.py`. Once set to your trained model and dataset you can begin evaluation with:

```
python network/evaluate.py
```

## Inference

## Comparison to state-of-the-art methods

|Method|Easy|Moderate|Hard|
|:-----|---:|-------:|---:|
|MonoDis|11.06|7.60|6.37|
|Ours|0.0|0.0|0.0|